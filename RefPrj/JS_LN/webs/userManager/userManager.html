<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> <html xmlns="http://www.w3.org/1999/xhtml"> <head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><link type="text/css" rel="stylesheet" href="../css/cfg_table.css">   <link type="text/css" rel="stylesheet" href="../lib/dijit/themes/soria/soria.css"><link type="text/css" rel="stylesheet" href="../css/jquery-ui-1.7.2.custom.css">  <link type="text/css" rel="stylesheet" href="../css/JTable.css" />          <!--jTable表格样式  含有JTable表格的页面包含--><link type="text/css" rel="stylesheet" href="../css/cfg_table.css" /> <script type="text/javascript"  src="../lib/jquery-1.4.2.min.js"></script><script type="text/javascript"  src="../lib/jquery.dataTables.min.js"></script><script type="text/javascript"  src="../script/JTable.js"></script><script type="text/javascript"  src="../script/cfgTable.js"></script><script type="text/javascript" src="../lib/dojo/dojo.js" djConfig="parseOnLoad:true,isDebug:true,locale:'en-us'"> </script> <script type="text/javascript" src="../lib/dijit/dijit.js"></script><script type="text/javascript" src="../script/localdojo.js"></script> 	<script type="text/javascript">var userData=[];var addormod =0;//0 add 1 modifyfunction init(){//$("table.cfgTable tbody>tr:odd").addClass("odd"); //奇数行样式	///初始化表格*/	   var columns= [	                 {"sTitle":'#', "sWidth":"100px"},	                 {"sTitle":'用户名', "sWidth":"200px"},					 {"sTitle":'用户权限', "sWidth":"200px"},					 {"sTitle":'描述', "sWidth":"200px"}		             ];	    	      jtable = new JTable({			      "columns" : columns,			      "data":	null,		          "sort": false,			      "detailMode": false,			      "singleRowSelected": true,			      "detailFunc": null,			      "container": 'jtableContainer',		  	      "tableId": "jtable",			      "rowCallback": convert		           });	  	  userData=[[1,'admin',[0,1],'dddd']];      jtable.show(userData);	 }	function convert(nRow, aData,iDisplayIndex){	var showHtml="";	  if(aData[2]){	     for(var i=0;i<aData[2].length;i++){		   if(aData[2][i]==0){		     showHtml+='查看权限；';		   }else if (aData[2][i]==1){		     showHtml+='新增权限；';		   }else if (aData[2][i]==2){		     showHtml+='修改权限；';		   }else if (aData[2][i]==3){		     showHtml+='删除权限；';		   }		 }		  $('td:eq(2)', nRow).html(showHtml);	  }	  return nRow;	}function addUser(){  addormod =0;   dijit.byId("userName").set("value","");   dijit.byId("description").set("value","");   var arrayPriDoc = document.getElementsByName("userPrivilege");	for( var i = 0,j=0; i < arrayPriDoc.length; i++ )	{		if ( arrayPriDoc[i].checked ){         arrayPriDoc[i].checked  =false;		}	}   dijit.byId("formDialog").show();}function deleteUser(){var deleteArr=jtable.getSelectedRows();	if(deleteArr==''){	  alert("请选中一行！");	  return;	 }else{	  var deleteArr = jtable.getSelectedRows();	  var arrPLen = deleteArr.length;	  var indexArray=[];	  for (i = 0; i < arrPLen; i++) {			var index = deleteArr[i].childNodes[0].innerHTML;			indexArray[i]=index;	 }	  jtable.deleteRows();	  for(var i=0;i<indexArray.length;i++){	     delete userData[indexArray[i]];	  }	  	  //delete userData[deleteArr];      jtable.show(userData);	  	    }}function modifyUser(){  addormod =1;   var upateRow = jtable.getSelectedRows();    if(upateRow==''){	  alert("请选中一行！");      return;    }else {        dijit.byId("formDialog").show();	   var index = upateRow[0].childNodes[0].innerHTML;	   setData2Dialog( userData[index-1]);			 }}function setData2Dialog(selectedData){    dijit.byId("userName").set("value",selectedData[1]);	var arrayPriDoc = document.getElementsByName("userPrivilege");	for(var i=0;i<selectedData[2].length;i++){	  if(selectedData[2][i]==0){	    arrayPriDoc[0].checked =true;	  }else if(selectedData[2][i]==1){	  arrayPriDoc[1].checked =true;	  }else if(selectedData[2][i]==2){	  arrayPriDoc[2].checked =true;	  }else if(selectedData[2][i]==3){	  arrayPriDoc[3].checked =true;	  }	}    dijit.byId("description").set("value",selectedData[3]);}function updateUser(){ var name =  dijit.byId("userName").get("value"); var arrayPriDoc = document.getElementsByName("userPrivilege"); var arrayPri=[];	for( var i = 0,j=0; i < arrayPriDoc.length; i++ )	{		if ( arrayPriDoc[i].checked ){		   arrayPri[j] = arrayPriDoc[i].value;		   j++;		}	} var userDescription = dijit.byId("description").get("value"); if(addormod==0){     var currentIndex = userData.length;     userData[currentIndex]=[currentIndex+1,name,arrayPri,userDescription]; }else{   var upateRow = jtable.getSelectedRows();   var index = upateRow[0].childNodes[0].innerHTML;   userData[index-1]=[index,name,arrayPri,userDescription];  }  dijit.byId("formDialog").hide();  jtable.show(userData);	 } function Cancel(){    dijit.byId("formDialog").hide();}</script></head><body class="soria" >  <div dojoType="dijit.TitlePane" id="outTitlePane" title='用户管理' closable="false">  <div >	<button onClick="addUser()">	添加	</button>	<button onClick="modifyUser()">	修改	</button>	<button onClick="deleteUser()">	删除	</button></div>		      			<table  class="cfgTable" id="task"  >  <tbody><tr>	<th  width="20%">编号</th>	<th width="25%">用户名</th>	<th width="25%">用户权限</th>	<th width="30%">描述</th>	</tr>	<tr>	<td align="left" >1#</td>  <td align="left" >admin</td>  <td align="left" >添加</td>    <td align="left" >--</td>    </tr> <tr>  <td align="left" >2#</td>  <td align="left">user</td>  <td align="left">--</td>  <td align="left">--</td> </tr> </tbody></table>		      <div dojoType="dijit.Dialog" id="formDialog" title='用户信息' style="display:none;">	         <table class='cfgTable' style="width:500px;height:100px"> 			 <tbody>			  <tr style="display:none">					<td>#</td>					<td>					   <input type="text" dojoType="dijit.form.ValidationTextBox" id="Index"   style="width:250px"/>					</td>			   </tr>			   <tr>					<td style="width:250px">用户名</td>					<td>					    <input type="text" dojoType="dijit.form.ValidationTextBox" id="userName"   style="width:250px"/>					</td>			   </tr>			   <tr>					<td style="width:250px">权限</td>					<td>					   <input type="checkbox" name="userPrivilege" value="0" /> 查看					   <input type="checkbox" name="userPrivilege" value="1" /> 新增					   <input type="checkbox" name="userPrivilege" value="2" /> 修改					   <input type="checkbox" name="userPrivilege" value="3" /> 删除					</td>			   </tr>			     <tr>					<td style="width:250px">用户信息描述</td>					<td>					    <input type="text" dojoType="dijit.form.ValidationTextBox" id="description"   style="width:250px"/>					</td>			   </tr>			   </tbody>			   </table>			  <div class="applyDiv">		    <button id="submitData" dojoType="dijit.form.Button" type="button" name="submitData" onClick="updateUser()">			确定			</button>			 <button id="cancel" dojoType="dijit.form.Button" type="button" name="cancel" onClick="Cancel()">	         取消	   	     </button>		  </div>			  </div>			   </body>			</html>